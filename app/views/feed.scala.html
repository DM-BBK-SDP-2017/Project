@import models.Interactions.Interaction
@import models.Users.User
@(
        artefacts:Seq[Artefact],
        loginForm:play.api.data.Form[User],
        user:String,
        interactionForm:play.api.data.Form[Interaction]

)(implicit messages: Messages)

@main( play.Play.application().configuration().getString("application.name") , loginForm ,user) {


    <script src='@routes.Assets.at("javascripts/FeedJsHelper.js")' type="text/javascript"></script>
    <script src='@routes.Assets.at("javascripts/magicsuggest/magicsuggest-min.js")' type="text/javascript"></script>
    <link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/magicsuggest-min.css")">

    <script>

            var groups = [];
            $.getJSON("api/groups").success(function(data) {

                for (var i = 0; i < data.length; i++) {
                    groups.push(data[i]);
                }
            });

    </script>


    <div class="container">
        <div class="row">
            <div class="col-12">

            @if(user != null) {
                <br>

                @for(a <- artefacts.slice(0,5)) {
                    <div class="panel panel-default" id="artefact_@a.id">
                        <div class="panel-body">

                        @Html(controllers.Utils.HTMLDecode(a.content))

                        </div>

                        <div class="panel-footer" id="dataParent_@a.id">

                            <div class="btn-group" id="likeButtons_@a.id">
                                <button class="btn btn-primary btn-default" onclick="like(@a.id)"><span class="glyphicon glyphicon-ok" aria-hidden="true"></span> Useful</button>
                                <button class="btn btn-primary btn-default" onclick="dislike(@a.id)"><span class="glyphicon glyphicon-remove" aria-hidden="true" ></span> Not Useful</button>
                            </div>
                            <div class="btn-group pull-right" id="moreAndCommentsButton_@a.id">
                                <div class="pull-right">


                                    <button type="button" class="btn btn-default btn-default pull-right">
                                        <a class="panel-toggle" data-parent="#dataParent_@a.id" onclick="more(@a.id)" id="more_button_@a.id" data-toggle="collapse" href="#more_@a.id"><span class="glyphicon glyphicon-star" aria-hidden="true"></span> More</a>
                                    </button>
                                    <button type="button" class="btn btn-default btn-default pull-right">
                                        <a class="panel-toggle" href="#" data-parent="#dataParent_@a.id"id="comment_button_@a.id" onclick="more(@a.id)"><span class="badge">5</span> Comments</a>
                                    </button>
                                </div>
                            </div>



                            <div class="collapse" id="more_@a.id">

                                <br>

                                <div class="btn-group">
                                    <button class="btn btn-default" href="#suggest_slidedown_@a.id" data-toggle="collapse" id="suggest_@a.id"><span class="glyphicon glyphicon-education" aria-hidden="true" ></span> Suggest improvement or update</button>
                                    <button class="btn btn-default" href="#recommend_slidedown_@a.id" data-toggle="collapse" id="recommend_@a.id"><span class="glyphicon glyphicon-education" aria-hidden="true" ></span> Recommend to others</button>
                                    <button class="btn btn-default" href="#alertAdmin_slidedown_@a.id" data-toggle="collapse" id="alertAdmin_@a.id"><span class="glyphicon glyphicon-alert" aria-hidden="true" ></span> Flag to administrator</button>

                                </div>
                                    <!--/div-->

                                @**@
                                @*Suggestion Slidedown*@

                                <div class="collapse" id="suggest_slidedown_@a.id">
                                    <br>

                                    <div class="col-12">
                                        <label>Suggest improvement or update</label>
                                        <div class="input-group">

                                            <input type="text" id="suggestion_content_@a.id" class="form-control" placeholder="Enter suggestion here">
                                            <span class="input-group-btn">
                                                <button class="btn btn-default" onclick="suggest(@a.id, @a.creator)" type="button">Go!</button>
                                            </span>
                                        </div><!-- /input-group -->
                                    </div><!-- /.col-lg-6 -->


                                </div>

                                @*End of Suggestion Slidedown*@


                                @*Recommend Slidedown*@


                                <div class="collapse" id="recommend_slidedown_@a.id">
                                    <br>
                                    <div class="container">

                                    <div class="row">
                                        <label>Choose a group you would recommend this to</label>
                                        <div class="input-group col-lg-6">

                                            <input id="recommend_chooser_@a.id" class="form-control" placeholder="Start typing to begin searching"> </input>
                                            <span class="input-group-btn">
                                                <button class="btn btn-default" id="selection_submit_@a.id" type="button">Go!</button>
                                            </span>

                                            <script>





                                                $(document).ready(function() {
                                                    $('#selection_submit_@a.id').bind('click', function() {
                                                        recommend(@a.id, recommendations_@{a.id}.getValue());


                                                    });


                                                    var recommendations_@a.id

                                                    console.log(groups)

                                                    recommendations_@a.id = $('#recommend_chooser_' +@a.id).magicSuggest({
                                                        allowFreeEntries: false,
                                                        placeholder: 'Begin typing to search for groups',
                                                        maxSelection: 1,
                                                        data: groups
                                                    });




                                                });

                                            </script>


                                        <!-- /input-group -->
                                    </div><!-- /.col-lg-6 -->

                                </div>
                                    </div>
                                </div>

                                @*End of Recommend Slidedown*@

                                @*Alert Slidedown*@

                                <div class="collapse" id="alertAdmin_slidedown_@a.id">
                                    <br>

                                    <div class="col-12">
                                        <label>Alert Administrator</label>
                                        <br>
                                        <em>Write why this content is not appropriate e.g. is the content defamatory, incorrect or otherwise inappropriate. Content will be suspended until administrator reviews your comment</em>
                                        <br>
                                        <div class="input-group">

                                            <input type="text" id="alertAdmin_content_@a.id" class="form-control" placeholder="Enter reasons here">
                                            <span class="input-group-btn">
                                                <button class="btn btn-default" onclick="alertAdmin(@a.id)" type="button">Go!</button>
                                            </span>
                                        </div><!-- /input-group -->
                                    </div><!-- /.col-lg-6 -->

                                </div>

                                @*End of Alert Slidedown*@


                            </div>


                        </div>
                    </div>

                }

            }   else {
                <p class="navbar-text pull-right" style="color: rgba(21,55,27,0.6) ;"><b>please sign in</b></p>
            }

            </div>
        </div>
    </div>
}